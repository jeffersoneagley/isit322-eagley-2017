let debug = require('debug')('git-convert');
debug('this is a test');

let fs = require("fs");

class GitFieldGenerator {

    handleInputDataType = (data) => {
        switch (typeof (data)) {
            case "string":
                return JSON.parse(data);
            case "object":
                return data;
            default:
                console.error('Invalid data of type ' + typeof (data))
        }
    };

    makeEntryFromDataType = (entry, value) => {
        let result = {
            id    : entry,
            label : entry + '-name',
            type  : 'paragraph',
            sample: entry + '-unknown'
        };
        switch (typeof (value)) {
            case 'datetime':
                result.type = 'year';
                break;
            default:
                result.type = 'paragraph';
        }

        return result;
    };

    processObjectToArray = (input) => {
        let arr = [];
        for (let entry in input) {
            if (input.hasOwnProperty(entry) &&
                input[entry] !== null) {
                let currentEntry = input[entry];
                // debug(entry);
                arr.push(this.makeEntryFromDataType(entry, currentEntry));
            }
        }
        return arr;
    };

    GetFields = (input) => {
        let data = this.handleInputDataType(input);
        let arr = this.processObjectToArray(data);
        return arr;
    };
}

export default GitFieldGenerator;

//
// function handleInput(input) {
//     let data = handleInputDataType(input);
//     let arr = processObjectToArray(data);
//     console.log('/*\n * Autogenerated by git-create-field-defs.js on: \n * ' +
//         new Date().toUTCString() +
//         '\n*/\n');
//     console.log('export default ', arr)
// }
//
// readFile('git-user.json').then(handleInput, console.error);